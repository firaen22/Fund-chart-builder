import{c as y,r as p,A as v,j as t}from"./index-CyRzKIcm.js";import{C as j}from"./calendar-L4zFdCQJ.js";import{C as N}from"./circle-check-NOcdro6E.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],M=y("calculator",D);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],C=y("chart-no-axes-column",R);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],_=y("percent",S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],z=y("triangle-alert",A),$=e=>{if(e.length<2)return 0;const s=e[0];return(e[e.length-1]-s)/s},q=e=>{let s=-1/0,l=0;for(const o of e){o>s&&(s=o);const d=(o-s)/s;d<l&&(l=d)}return l},F=e=>{if(e.length<2)return 0;const s=[];for(let n=1;n<e.length;n++)s.push((e[n]-e[n-1])/e[n-1]);const l=s.reduce((n,c)=>n+c,0)/s.length,o=s.reduce((n,c)=>n+Math.pow(c-l,2),0)/s.length;return Math.sqrt(o)*Math.sqrt(252)},I=(e,s=0)=>{if(e.length<2)return 0;const l=[];for(let a=1;a<e.length;a++)l.push((e[a]-e[a-1])/e[a-1]);const o=l.reduce((a,u)=>a+u,0)/l.length,d=l.reduce((a,u)=>a+Math.pow(u-o,2),0)/l.length,n=Math.sqrt(d);if(n===0)return 0;const c=Math.pow(1+o,252)-1,i=n*Math.sqrt(252);return(c-s)/i},V=(e,s=14)=>{if(e.length<=s)return 0;const l=[],o=[];for(let i=1;i<e.length;i++){const a=e[i]-e[i-1];a>=0?(l.push(a),o.push(0)):(l.push(0),o.push(Math.abs(a)))}let d=l.slice(0,s).reduce((i,a)=>i+a,0)/s,n=o.slice(0,s).reduce((i,a)=>i+a,0)/s;for(let i=s;i<e.length-1;i++){const a=l[i],u=o[i];d=(d*(s-1)+a)/s,n=(n*(s-1)+u)/s}return n===0?100:100-100/(1+d/n)},L=(e,s,l,o)=>{let d=e;l&&o&&(d=e.filter(c=>c.date>=l&&c.date<=o));const n=d.map(c=>c[s]).filter(c=>typeof c=="number");return n.length===0?null:{cumulativeReturn:$(n),maxDrawdown:q(n),volatility:F(n),sharpeRatio:I(n),rsi:V(n)}},T=({dataset:e,lang:s})=>{const[l,o]=p.useState(()=>e.data.length>0?e.data[0].date:""),[d,n]=p.useState(()=>e.data.length>0?e.data[e.data.length-1].date:""),[c,i]=p.useState({sharpeRatio:!1,maxDrawdown:!0,cumulativeReturn:!0,volatility:!1,rsi:!1}),a={en:{title:"Financial Metrics",subtitle:"Advanced quantitative analysis",dateRange:"Analysis Period",metrics:"Select Indicators",sharpe:"Sharpe Ratio",sharpeDesc:"Risk-adjusted return",mdd:"Max Drawdown",mddDesc:"Worst possible loss",return:"Cumulative Return",returnDesc:"Total profit/loss",volatility:"Ann. Volatility",volatilityDesc:"Price stability",rsi:"RSI (14)",rsiDesc:"Momentum indicator",fund:"Fund Name",noData:"No data available for the selected range."},cn:{title:"財務指標分析",subtitle:"高級定量分析",dateRange:"分析期間",metrics:"選擇指標",sharpe:"夏普比率",sharpeDesc:"每一單位風險的超額回報",mdd:"最大回撤",mddDesc:"期間內最大跌幅",return:"累積回報",returnDesc:"期間總獲利",volatility:"年化波動率",volatilityDesc:"價格變動劇烈程度",rsi:"相對強弱指數 (RSI)",rsiDesc:"趨勢與買賣力道",fund:"基金名稱",noData:"所選範圍內無數據。"}}[s],u=[{key:"cumulativeReturn",label:a.return,desc:a.returnDesc,icon:_,color:"text-emerald-600"},{key:"maxDrawdown",label:a.mdd,desc:a.mddDesc,icon:z,color:"text-red-500"},{key:"sharpeRatio",label:a.sharpe,desc:a.sharpeDesc,icon:v,color:"text-indigo-600"},{key:"volatility",label:a.volatility,desc:a.volatilityDesc,icon:v,color:"text-orange-500"},{key:"rsi",label:a.rsi,desc:a.rsiDesc,icon:C,color:"text-purple-600"}],w=p.useMemo(()=>{const r={};return e.funds.forEach(h=>{r[h]=L(e.data,h,l,d)}),r},[e,l,d]),k=r=>{i(h=>({...h,[r]:!h[r]}))},g=u.filter(r=>c[r.key]);return t.jsxs("div",{className:"bg-white rounded-3xl border border-surface-200 shadow-lg overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"px-6 py-5 bg-surface-50 border-b border-surface-200 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"bg-brand-100 p-2 rounded-lg text-brand-700",children:t.jsx(M,{className:"w-5 h-5"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-bold text-surface-900 uppercase tracking-widest",children:a.title}),t.jsx("p",{className:"text-[10px] text-surface-500 font-medium",children:a.subtitle})]})]}),t.jsxs("div",{className:"flex items-center gap-2 bg-white p-1 rounded-lg border border-surface-200 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 border-r border-surface-100",children:[t.jsx(j,{className:"w-3.5 h-3.5 text-surface-400"}),t.jsx("span",{className:"text-[10px] font-bold text-surface-500 uppercase tracking-wider",children:a.dateRange})]}),t.jsx("input",{type:"date",value:l,onChange:r=>o(r.target.value),className:"text-xs font-mono font-bold text-surface-900 bg-transparent border-none focus:ring-0 p-1"}),t.jsx("span",{className:"text-surface-300",children:"-"}),t.jsx("input",{type:"date",value:d,onChange:r=>n(r.target.value),className:"text-xs font-mono font-bold text-surface-900 bg-transparent border-none focus:ring-0 p-1"})]})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex flex-wrap gap-3",children:u.map(r=>t.jsxs("button",{onClick:()=>k(r.key),className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all duration-200 ease-out active:scale-95 ${c[r.key]?"bg-brand-50 border-brand-200 shadow-sm":"bg-white border-surface-200 hover:bg-surface-50 text-surface-400"}`,children:[t.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${c[r.key]?"bg-brand-500 text-white":"bg-surface-200"}`,children:c[r.key]&&t.jsx(N,{className:"w-3 h-3 animate-in zoom-in duration-300 ease-out"})}),t.jsx("div",{className:"text-left",children:t.jsx("span",{className:`block text-[10px] font-bold uppercase tracking-wider ${c[r.key]?"text-brand-900":"text-surface-500"}`,children:r.label})})]},r.key))}),t.jsxs("div",{className:"overflow-x-auto rounded-xl border border-surface-200",children:[t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-surface-50/80 text-[10px] font-bold uppercase text-surface-500 tracking-widest border-b border-surface-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 bg-surface-50 sticky left-0 z-10",children:a.fund}),g.map(r=>t.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(r.icon,{className:`w-3.5 h-3.5 ${r.color}`}),t.jsx("span",{children:r.label})]})},r.key))]})}),t.jsx("tbody",{className:"divide-y divide-surface-100 font-mono text-xs",children:e.funds.map(r=>{const h=w[r];return h?t.jsxs("tr",{className:"hover:bg-brand-50/30 transition-colors group",children:[t.jsx("td",{className:"px-6 py-4 font-bold text-surface-900 bg-white group-hover:bg-brand-50/30 sticky left-0 border-r border-surface-100 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]",children:r}),g.map(x=>{let f=h[x.key],b="—",m="text-surface-600";return f!=null&&!isNaN(f)&&(x.key==="cumulativeReturn"||x.key==="maxDrawdown"||x.key==="volatility"?(b=(f*100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%",x.key==="cumulativeReturn"?m=f>=0?"text-emerald-600 font-bold":"text-red-500 font-bold":x.key==="maxDrawdown"&&(m="text-red-500 font-bold")):(b=f.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),x.key==="sharpeRatio"&&(m=f>1?"text-emerald-600 font-bold":f<0?"text-red-500":"text-surface-700"))),t.jsx("td",{className:`px-6 py-4 tabular-nums ${m}`,children:b},x.key)})]},r):null})})]}),g.length===0&&t.jsx("div",{className:"p-8 text-center text-surface-400 text-sm font-medium italic",children:a.metrics})]})]})]})};export{T as FinancialMetrics};
