import{c as u,r as p,j as e,S as A,D as z}from"./index-L6l2XGnq.js";import{C as T}from"./circle-check-bTB_9b9F.js";import{I as $}from"./info-CN2J9231.js";import{C as E}from"./calendar-u5kjkaRE.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],j=u("arrow-right",I);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],P=u("bookmark",L);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],F=u("circle-plus",V);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],R=u("clipboard-paste",H);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],B=u("file-text",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],G=u("hash",O);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],K=u("history",U);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],W=u("layers",Q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],J=u("layout-grid",Z);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Y=u("trash-2",X);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],te=u("wand-sparkles",ee),N=r=>{try{const d=new Date(r);return isNaN(d.getTime())?r.trim():d.toISOString().split("T")[0]}catch{return r.trim()}},k=r=>{const d=r.trim().split(/\r?\n/),o=[];for(const c of d){const s=c.split(/[\t]| {2,}/).map(n=>n.trim()).filter(n=>n.length>0);if(s.length<2)continue;let a="",i=null;for(const n of s){const f=n.replace(/[$\u00A5\u20AC]/g,"").replace(/,/g,""),b=parseFloat(f);!isNaN(b)&&i===null&&!/[\/ \-]/.test(n)&&!/[a-zA-Z]/.test(n)?i=b:a===""&&(a=N(n))}a&&i!==null&&o.push({date:a,value:i})}return o},ae=r=>{const d=r.map(a=>a.code),o={},c={};r.forEach(a=>{o[a.code]={description:a.description},k(a.rawText).forEach(n=>{c[n.date]||(c[n.date]={date:n.date},d.forEach(f=>{c[n.date][f]=null})),c[n.date][a.code]=n.value})});const s=Object.values(c).sort((a,i)=>a.date.localeCompare(i.date));return{funds:d,data:s,metadata:o}},se=(r,d)=>{if(d==="original")return r;if(d==="intersect")return{...r,data:r.data.filter(s=>r.funds.every(a=>typeof s[a]=="number"))};let o=r.data.map(s=>({...s}));const c={};return r.funds.forEach(s=>c[s]=null),o.forEach(s=>{r.funds.forEach(a=>{const i=s[a];typeof i=="number"?c[a]=i:c[a]!==null&&(s[a]=c[a],s[`_synthetic_${a}`]=!0)})}),o=o.filter(s=>r.funds.every(a=>typeof s[a]=="number")),{...r,data:o}},de=({onComplete:r,lang:d})=>{const[o,c]=p.useState("input"),[s,a]=p.useState([]),[i,n]=p.useState(""),[f,b]=p.useState(""),[g,w]=p.useState(""),[y,M]=p.useState(null),[v,S]=p.useState("forwardFill"),m=p.useMemo(()=>y?se(y,v):null,[y,v]),l={en:{auditTitle:"Reconciliation Engine",auditSub:"Dataset Alignment Audit",validated:"Validated Samples",back:"Modify Components",launch:"Initialize Hub",policy:"Aggregation Logic",strategies:[{id:"forwardFill",label:"Linear Forward Fill",desc:"Auto-synthesize gaps using last known observations."},{id:"intersect",label:"Strict Temporal Fit",desc:"Retain only records shared by all constituents."},{id:"original",label:"Native Sparse Data",desc:"Process dataset with existing gaps intact."}],temporalIndex:"Temporal Index",absent:"NO DATA",assembler:"Multi-Asset Assembler",assemblerSub:"Custom Index Engineering",definition:"Define Component",symbol:"Identifier (e.g. S&P500)",description:"Brief Label",navSet:"Value Stream (Paste CSV/Tabular)",commit:"Add Component",guide:["Select your asset identifier.","Paste NAV/Price history from Excel or terminal.","Aggregate multiple assets to build a composite index."],vaulted:"Asset Inventory",empty:"Queue Empty",points:"Records",execute:"Process Aggregation"},cn:{auditTitle:"對賬引擎",auditSub:"數據集對齊審計",validated:"經驗證樣本",back:"修改組件",launch:"初始化中心",policy:"彙總邏輯",strategies:[{id:"forwardFill",label:"線性前向填充",desc:"使用最後觀測值自動合成缺口。"},{id:"intersect",label:"嚴格時間擬合",desc:"僅保留所有成分共有的記錄。"},{id:"original",label:"原始稀疏數據",desc:"完整保留現有缺口處理數據集。"}],temporalIndex:"時間索引",absent:"無數據",assembler:"多資產組裝器",assemblerSub:"定制指數工程",definition:"定義組件",symbol:"標識符 (如 S&P500)",description:"簡要標籤",navSet:"價值流 (貼入 CSV/製表符數據)",commit:"添加組件",guide:["選擇您的資產標識符。","從 Excel 或終端貼入淨值/價格歷史。","彙總多個資產以構建綜合指數。"],vaulted:"資產庫存",empty:"隊列為空",points:"條記錄",execute:"執行彙總"}}[d],C=()=>{const t=ae(s);t!=null&&t.data.length&&(M(t),c("reconcile"))},_=()=>{i&&g&&(a(t=>[...t,{code:i,description:f||i,rawText:g}]),n(""),b(""),w(""))};return o==="reconcile"&&m?e.jsxs("div",{className:"w-full max-w-7xl mx-auto space-y-6 animate-in fade-in zoom-in duration-500",children:[e.jsxs("div",{className:"bg-surface-900 p-8 text-white shadow-2xl rounded-3xl border border-surface-800 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.05]",children:e.jsx(A,{className:"w-32 h-32"})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-brand-600 flex items-center justify-center text-white shadow-lg",children:e.jsx(T,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-extrabold tracking-tight",children:l.auditTitle}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsxs("span",{className:"text-surface-400 text-[10px] font-bold uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(z,{className:"w-3 h-3"})," ",m.data.length," ",l.validated]}),e.jsxs("span",{className:"text-brand-400 text-[10px] font-bold uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(P,{className:"w-3 h-3"})," ",l.auditSub]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>c("input"),className:"px-5 py-2.5 bg-surface-800 hover:bg-surface-700 text-white rounded-xl text-xs font-bold transition-all border border-surface-700",children:l.back}),e.jsxs("button",{onClick:()=>r(m),className:"px-8 py-2.5 bg-brand-500 hover:bg-brand-600 text-white rounded-xl text-xs font-bold shadow-lg transition-all duration-300 ease-out active:scale-[0.98] flex items-center gap-2 bg-gradient-to-r from-brand-500 via-brand-400 to-brand-500 animate-shimmer hover:shadow-brand-500/25",children:[l.launch," ",e.jsx(j,{className:"w-4 h-4"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl border border-surface-200 shadow-xl overflow-hidden flex flex-col md:flex-row min-h-[600px]",children:[e.jsxs("div",{className:"w-full md:w-80 bg-surface-50 p-10 border-r border-surface-200 space-y-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-brand-600"}),e.jsx("h3",{className:"text-[10px] font-bold text-surface-900 uppercase tracking-widest",children:l.policy})]}),e.jsx("div",{className:"space-y-3",children:l.strategies.map(t=>e.jsxs("button",{onClick:()=>S(t.id),className:`w-full text-left p-5 rounded-2xl border transition-all ${v===t.id?"border-brand-500 bg-white shadow-md ring-1 ring-brand-500":"border-surface-200 opacity-60 hover:opacity-100 hover:bg-white"}`,children:[e.jsx("p",{className:"text-xs font-extrabold text-surface-900 uppercase tracking-tight mb-1",children:t.label}),e.jsx("p",{className:"text-[10px] text-surface-500 font-medium leading-relaxed",children:t.desc})]},t.id))})]}),e.jsx("div",{className:"flex-grow overflow-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse font-mono text-[11px]",children:[e.jsx("thead",{className:"sticky top-0 bg-white z-20 border-b border-surface-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-5 bg-surface-50 font-bold uppercase text-surface-400 tracking-widest",children:l.temporalIndex}),m.funds.map(t=>{var x,h;return e.jsx("th",{className:"p-5 font-extrabold uppercase text-surface-900 tracking-tight",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:t}),e.jsx("span",{className:"text-[9px] text-surface-400 normal-case font-medium",children:(h=(x=m.metadata)==null?void 0:x[t])==null?void 0:h.description})]})},t)})]})}),e.jsx("tbody",{className:"divide-y divide-surface-100",children:m.data.map((t,x)=>e.jsxs("tr",{className:"hover:bg-surface-50 transition-colors group",children:[e.jsx("td",{className:"p-5 font-bold text-surface-900 border-r border-surface-100 tabular-nums",children:t.date}),m.funds.map(h=>e.jsx("td",{className:`p-5 tabular-nums ${t[`_synthetic_${h}`]?"text-brand-600 font-extrabold":"text-surface-600 font-medium"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[t[h]!==null?t[h].toLocaleString(void 0,{minimumFractionDigits:2}):e.jsx("span",{className:"text-surface-300 text-[10px] font-bold italic",children:l.absent}),t[`_synthetic_${h}`]&&e.jsx(K,{className:"w-3.5 h-3.5 opacity-50 ml-2"})]})},h))]},x))})]})})]})]}):e.jsxs("div",{className:"w-full flex flex-col md:flex-row divide-y md:divide-y-0 md:divide-x divide-surface-200",children:[e.jsxs("div",{className:"flex-grow p-10 lg:p-14 space-y-10",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"bg-brand-50 px-2 py-1 rounded text-brand-600 text-[10px] font-bold uppercase tracking-widest inline-flex items-center gap-1 mb-2",children:[e.jsx(W,{className:"w-3 h-3"})," ",l.assemblerSub]}),e.jsx("h2",{className:"text-2xl font-extrabold text-surface-900 tracking-tight",children:l.assembler})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-bold text-surface-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(G,{className:"w-3.5 h-3.5 text-brand-500"})," ",l.symbol]}),e.jsx("input",{type:"text",placeholder:"e.g. BTC-USD",className:"w-full px-4 py-3 bg-surface-50 border border-surface-200 rounded-xl font-bold focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-sm placeholder:text-surface-300",value:i,onChange:t=>n(t.target.value.toUpperCase())})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-bold text-surface-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(B,{className:"w-3.5 h-3.5 text-brand-500"})," ",l.description]}),e.jsx("input",{type:"text",placeholder:"e.g. Digital Gold",className:"w-full px-4 py-3 bg-surface-50 border border-surface-200 rounded-xl font-medium focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all text-sm placeholder:text-surface-300",value:f,onChange:t=>b(t.target.value)})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsxs("label",{className:"text-[10px] font-bold text-surface-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(R,{className:"w-3.5 h-3.5 text-brand-500"})," ",l.navSet]}),e.jsx("textarea",{placeholder:"Date,Value...",className:"w-full px-4 py-3 bg-surface-50 border border-surface-200 rounded-xl font-mono text-xs h-32 focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all resize-none placeholder:text-surface-300",value:g,onChange:t=>w(t.target.value)})]})]}),e.jsxs("button",{onClick:_,disabled:!i||!g,className:"w-full py-4 bg-brand-600 hover:bg-brand-700 disabled:bg-surface-200 text-white rounded-xl font-bold text-sm transition-all duration-200 ease-out shadow-lg flex items-center justify-center gap-2 active:scale-[0.98]",children:[e.jsx(F,{className:"w-4 h-4"})," ",l.commit]}),e.jsxs("div",{className:"p-5 bg-surface-50 rounded-2xl border border-surface-200 flex gap-4",children:[e.jsx($,{className:"w-5 h-5 text-brand-600 shrink-0 mt-0.5"}),e.jsx("div",{className:"text-[11px] text-surface-500 font-medium leading-relaxed space-y-2",children:l.guide.map((t,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{children:[x+1,"."]}),t]},x))})]})]}),e.jsxs("div",{className:"w-full md:w-[380px] p-10 lg:p-14 bg-surface-900 text-white flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-400"}),e.jsx("h4",{className:"text-[10px] font-bold uppercase tracking-widest text-brand-400",children:l.vaulted})]}),e.jsx("span",{className:"px-2 py-0.5 bg-brand-500/20 text-brand-300 text-[10px] font-bold rounded border border-brand-500/30",children:s.length})]}),e.jsx("div",{className:"flex-grow space-y-3 overflow-y-auto pr-2 custom-scrollbar",children:s.length?s.map((t,x)=>e.jsxs("div",{style:{animationDelay:`${x*50}ms`},className:"bg-slate-800/50 backdrop-blur-sm p-4 rounded-xl border border-white/5 flex justify-between items-center group animate-in fade-in slide-in-from-right-8 duration-500 ease-out fill-mode-both hover:-translate-y-0.5 hover:bg-white/10 transition-all shadow-sm",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-extrabold text-white text-sm tracking-tight truncate",children:t.code}),e.jsx("span",{className:"text-[10px] text-slate-300 font-medium truncate block mb-1",children:t.description}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[9px] text-brand-300 font-bold uppercase tracking-tighter",children:[e.jsx(E,{className:"w-3 h-3"}),k(t.rawText).length," ",l.points]})]}),e.jsx("button",{onClick:()=>a(h=>h.filter((re,D)=>D!==x)),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-400/20 rounded-lg transition-all duration-200 ease-out hover:scale-110 active:scale-90 shrink-0",children:e.jsx(Y,{className:"w-4 h-4"})})]},x)):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-40 text-center space-y-4",children:[e.jsx("div",{className:"p-4 bg-white/5 rounded-full backdrop-blur-sm border border-white/5",children:e.jsx(J,{className:"w-8 h-8 text-white"})}),e.jsx("p",{className:"text-[10px] font-bold text-white uppercase tracking-widest",children:l.empty})]})}),e.jsxs("button",{onClick:C,disabled:!s.length,children:[l.execute," ",e.jsx(j,{className:"w-4 h-4"})]})]})]})};export{de as DataRestructurer};
