import{c as h,r as m,j as e,S as A,D as $}from"./index-BMuFwZ9R.js";import{C as z}from"./circle-check-q0rltIL2.js";import{I as T}from"./info-Bem3oiG_.js";import{C as E}from"./calendar-ChCR4rsp.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],N=h("arrow-right",I);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],P=h("bookmark",L);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],F=h("circle-plus",V);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],R=h("clipboard-paste",H);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],B=h("file-text",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],G=h("hash",O);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],K=h("history",U);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],W=h("layers",Q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],J=h("layout-grid",Z);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Y=h("trash-2",X);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],te=h("wand-sparkles",ee),v=l=>{try{const o=new Date(l);return isNaN(o.getTime())?l.trim():o.toISOString().split("T")[0]}catch{return l.trim()}},j=l=>{const o=l.trim().split(/\r?\n/),d=[];for(const c of o){const s=c.split(/[\t]| {2,}/).map(r=>r.trim()).filter(r=>r.length>0);if(s.length<2)continue;let a="",n=null;for(const r of s){const g=r.replace(/[$\u00A5\u20AC]/g,"").replace(/,/g,""),b=parseFloat(g);!isNaN(b)&&n===null&&!/[\/ \-]/.test(r)&&!/[a-zA-Z]/.test(r)?n=b:a===""&&(a=v(r))}a&&n!==null&&d.push({date:a,value:n})}return d},ae=l=>{const o=l.map(a=>a.code),d={},c={};l.forEach(a=>{d[a.code]={description:a.description},j(a.rawText).forEach(r=>{c[r.date]||(c[r.date]={date:r.date},o.forEach(g=>{c[r.date][g]=null})),c[r.date][a.code]=r.value})});const s=Object.values(c).sort((a,n)=>a.date.localeCompare(n.date));return{funds:o,data:s,metadata:d}},se=(l,o)=>{if(o==="original")return l;if(o==="intersect")return{...l,data:l.data.filter(s=>l.funds.every(a=>typeof s[a]=="number"))};let d=l.data.map(s=>({...s}));const c={};return l.funds.forEach(s=>c[s]=null),d.forEach(s=>{l.funds.forEach(a=>{const n=s[a];typeof n=="number"?c[a]=n:c[a]!==null&&(s[a]=c[a],s[`_synthetic_${a}`]=!0)})}),d=d.filter(s=>l.funds.every(a=>typeof s[a]=="number")),{...l,data:d}},oe=({onComplete:l,lang:o})=>{const[d,c]=m.useState("input"),[s,a]=m.useState([]),[n,r]=m.useState(""),[g,b]=m.useState(""),[f,k]=m.useState(""),[w,M]=m.useState(null),[y,S]=m.useState("forwardFill"),u=m.useMemo(()=>w?se(w,y):null,[w,y]),i={en:{auditTitle:"Reconciliation Engine",auditSub:"Dataset Alignment Audit",validated:"Validated Samples",back:"Modify Components",launch:"Initialize Hub",policy:"Aggregation Logic",strategies:[{id:"forwardFill",label:"Linear Forward Fill",desc:"Auto-synthesize gaps using last known observations."},{id:"intersect",label:"Strict Temporal Fit",desc:"Retain only records shared by all constituents."},{id:"original",label:"Native Sparse Data",desc:"Process dataset with existing gaps intact."}],temporalIndex:"Temporal Index",absent:"NO DATA",assembler:"Multi-Asset Assembler",assemblerSub:"Custom Index Engineering",definition:"Define Component",symbol:"Identifier (e.g. S&P500)",description:"Brief Label",navSet:"Value Stream (Paste CSV/Tabular)",commit:"Add Component",guide:["Select your asset identifier.","Paste NAV/Price history from Excel or terminal.","Aggregate multiple assets to build a composite index."],vaulted:"Asset Inventory",empty:"Queue Empty",points:"Records",execute:"Process Aggregation"},cn:{auditTitle:"對賬引擎",auditSub:"數據集對齊審計",validated:"經驗證樣本",back:"修改組件",launch:"初始化中心",policy:"彙總邏輯",strategies:[{id:"forwardFill",label:"線性前向填充",desc:"使用最後觀測值自動合成缺口。"},{id:"intersect",label:"嚴格時間擬合",desc:"僅保留所有成分共有的記錄。"},{id:"original",label:"原始稀疏數據",desc:"完整保留現有缺口處理數據集。"}],temporalIndex:"時間索引",absent:"無數據",assembler:"多資產組裝器",assemblerSub:"定制指數工程",definition:"定義組件",symbol:"標識符 (如 S&P500)",description:"簡要標籤",navSet:"價值流 (貼入 CSV/製表符數據)",commit:"添加組件",guide:["選擇您的資產標識符。","從 Excel 或終端貼入淨值/價格歷史。","彙總多個資產以構建綜合指數。"],vaulted:"資產庫存",empty:"隊列為空",points:"條記錄",execute:"執行彙總"}}[o],C=()=>{const t=ae(s);t!=null&&t.data.length&&(M(t),c("reconcile"))},_=()=>{n&&f&&(a(t=>[...t,{code:n,description:g||n,rawText:f}]),r(""),b(""),k(""))};return d==="reconcile"&&u?e.jsxs("div",{className:"w-full max-w-7xl mx-auto space-y-6 animate-in fade-in zoom-in duration-700",children:[e.jsxs("div",{className:"glass-panel p-10 text-white shadow-2xl rounded-[2.5rem] border-white/5 relative overflow-hidden backdrop-blur-3xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-10 opacity-5 pointer-events-none",children:e.jsx(A,{className:"w-48 h-48"})}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-10 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl glass-cta flex items-center justify-center text-white shadow-2xl",children:e.jsx(z,{className:"w-10 h-10"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black tracking-tight bg-clip-text text-transparent bg-gradient-to-b from-white to-slate-400",children:i.auditTitle}),e.jsxs("div",{className:"flex gap-6 mt-2",children:[e.jsxs("span",{className:"text-slate-400 text-[10px] font-black uppercase tracking-[0.2em] flex items-center gap-2",children:[e.jsx($,{className:"w-3.5 h-3.5 text-indigo-400"})," ",u.data.length," ",i.validated]}),e.jsxs("span",{className:"text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] flex items-center gap-2",children:[e.jsx(P,{className:"w-3.5 h-3.5"})," ",i.auditSub]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>c("input"),className:"px-6 py-3.5 glass-button-secondary rounded-xl text-xs font-black uppercase tracking-widest",children:i.back}),e.jsxs("button",{onClick:()=>l(u),className:"px-10 py-3.5 glass-cta rounded-xl text-xs font-black uppercase tracking-[0.1em] shadow-indigo-500/20 flex items-center gap-3",children:[i.launch," ",e.jsx(N,{className:"w-4 h-4"})]})]})]})]}),e.jsxs("div",{className:"glass-panel rounded-[2.5rem] border-white/5 shadow-2xl overflow-hidden flex flex-col md:flex-row min-h-[650px] backdrop-blur-3xl",children:[e.jsxs("div",{className:"w-full md:w-80 bg-black/20 p-10 border-r border-white/5 space-y-12",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-indigo-400"}),e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:i.policy})]}),e.jsx("div",{className:"space-y-4",children:i.strategies.map(t=>e.jsxs("button",{onClick:()=>S(t.id),className:`w-full text-left p-6 rounded-2xl border transition-all duration-300 ${y===t.id?"border-indigo-500/50 bg-indigo-500/10 shadow-2xl shadow-indigo-500/10":"border-white/5 opacity-40 hover:opacity-100 hover:bg-white/5"}`,children:[e.jsx("p",{className:"text-xs font-black text-white uppercase tracking-wider mb-1.5",children:t.label}),e.jsx("p",{className:"text-[10px] text-slate-400 font-medium leading-relaxed tracking-wide",children:t.desc})]},t.id))})]}),e.jsx("div",{className:"flex-grow overflow-auto custom-scrollbar bg-black/5",children:e.jsxs("table",{className:"w-full text-left border-collapse font-mono text-[11px]",children:[e.jsx("thead",{className:"sticky top-0 bg-slate-900 shadow-xl z-20 border-b border-white/5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-6 bg-black/40 font-black uppercase text-slate-500 tracking-[0.2em]",children:i.temporalIndex}),u.funds.map(t=>{var x,p;return e.jsx("th",{className:"p-6 font-black uppercase text-white tracking-widest bg-black/20",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-indigo-400",children:t}),e.jsx("span",{className:"text-[9px] text-slate-500 normal-case font-medium mt-1 tracking-tight",children:(p=(x=u.metadata)==null?void 0:x[t])==null?void 0:p.description})]})},t)})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:u.data.map((t,x)=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"p-6 font-black text-white border-r border-white/5 tabular-nums tracking-wider",children:t.date}),u.funds.map(p=>e.jsx("td",{className:`p-6 tabular-nums ${t[`_synthetic_${p}`]?"text-indigo-400 font-black":"text-slate-300 font-medium"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[t[p]!==null?t[p].toLocaleString(void 0,{minimumFractionDigits:2}):e.jsx("span",{className:"text-slate-600 text-[10px] font-black italic tracking-widest",children:i.absent}),t[`_synthetic_${p}`]&&e.jsx(K,{className:"w-4 h-4 opacity-40 ml-3"})]})},p))]},x))})]})})]})]}):e.jsxs("div",{className:"w-full flex flex-col md:flex-row divide-y md:divide-y-0 md:divide-x divide-white/5",children:[e.jsxs("div",{className:"flex-grow p-10 lg:p-14 space-y-12",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-indigo-500/10 px-3 py-1.5 rounded-xl text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] inline-flex items-center gap-2 mb-3 border border-indigo-500/20 shadow-lg shadow-indigo-500/10",children:[e.jsx(W,{className:"w-4 h-4"})," ",i.assemblerSub]}),e.jsx("h2",{className:"text-3xl font-black text-white tracking-tight",children:i.assembler})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] flex items-center gap-3",children:[e.jsx(G,{className:"w-4 h-4 text-indigo-500"})," ",i.symbol]}),e.jsx("input",{type:"text",placeholder:"e.g. BTC-USD",className:"w-full px-5 py-4 glass-input rounded-2xl font-black focus:ring-indigo-500 transition-all text-sm placeholder:text-slate-600 tracking-wider",value:n,onChange:t=>r(t.target.value.toUpperCase())})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] flex items-center gap-3",children:[e.jsx(B,{className:"w-4 h-4 text-indigo-500"})," ",i.description]}),e.jsx("input",{type:"text",placeholder:"e.g. Digital Gold",className:"w-full px-5 py-4 glass-input rounded-2xl font-bold focus:ring-indigo-500 transition-all text-sm placeholder:text-slate-600 tracking-wide",value:g,onChange:t=>b(t.target.value)})]}),e.jsxs("div",{className:"space-y-3 md:col-span-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] flex items-center gap-3",children:[e.jsx(R,{className:"w-4 h-4 text-indigo-500"})," ",i.navSet]}),e.jsx("textarea",{placeholder:"Date,Value...",className:"w-full px-5 py-4 glass-input rounded-2xl font-mono text-xs h-40 focus:ring-indigo-500 transition-all resize-none placeholder:text-slate-600 shadow-inner",value:f,onChange:t=>k(t.target.value)})]})]}),e.jsxs("button",{onClick:_,disabled:!n||!f,className:`w-full py-5 rounded-2xl font-black text-xs uppercase tracking-[0.2em] transition-all duration-500 flex items-center justify-center gap-3 shadow-2xl ${!n||!f?"bg-white/5 text-slate-600 cursor-not-allowed border border-white/5":"glass-cta shadow-indigo-500/20"}`,children:[e.jsx(F,{className:"w-5 h-5"})," ",i.commit]}),e.jsxs("div",{className:"p-6 bg-white/5 rounded-2xl border border-white/5 flex gap-5 shadow-2xl backdrop-blur-md",children:[e.jsx(T,{className:"w-6 h-6 text-indigo-400 shrink-0 mt-0.5"}),e.jsx("div",{className:"text-[11px] text-slate-400 font-medium leading-relaxed space-y-3 tracking-wide",children:i.guide.map((t,x)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("span",{className:"text-indigo-300 font-black",children:["0",x+1]}),e.jsx("span",{className:"border-l border-white/10 pl-3",children:t})]},x))})]})]}),e.jsxs("div",{className:"w-full md:w-[420px] p-10 lg:p-14 bg-black/30 backdrop-blur-3xl border-l border-white/5 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.8)] animate-pulse"}),e.jsx("h4",{className:"text-[11px] font-black uppercase tracking-[0.3em] text-indigo-400",children:i.vaulted})]}),e.jsxs("span",{className:"px-3 py-1 bg-white/5 text-white text-[10px] font-black rounded-lg border border-white/10 shadow-lg",children:[s.length," Assets"]})]}),e.jsx("div",{className:"flex-grow space-y-4 overflow-y-auto pr-2 custom-scrollbar",children:s.length?s.map((t,x)=>e.jsxs("div",{style:{animationDelay:`${x*100}ms`},className:"bg-white/5 backdrop-blur-xl p-5 rounded-2xl border border-white/5 flex justify-between items-center group animate-in fade-in slide-in-from-right-8 duration-700 ease-out fill-mode-both hover:-translate-y-1 hover:bg-white/10 transition-all shadow-xl hover:shadow-indigo-500/5 hover:border-white/10",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-black text-white text-sm tracking-widest truncate uppercase",children:t.code}),e.jsx("span",{className:"text-[10px] text-slate-500 font-bold truncate block mb-2 tracking-wide",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2.5 text-[9px] text-indigo-400 font-black uppercase tracking-widest",children:[e.jsx(E,{className:"w-3.5 h-3.5"}),j(t.rawText).length," ",i.points]})]}),e.jsx("button",{onClick:()=>a(p=>p.filter((le,D)=>D!==x)),className:"p-2.5 text-slate-600 hover:text-red-400 hover:bg-red-400/10 rounded-xl transition-all duration-300 ease-out hover:rotate-90 active:scale-75 shrink-0 border border-transparent hover:border-red-400/20",children:e.jsx(Y,{className:"w-5 h-5"})})]},x)):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 text-center space-y-6",children:[e.jsx("div",{className:"p-8 bg-white/5 rounded-full backdrop-blur-2xl border border-white/10 shadow-2xl",children:e.jsx(J,{className:"w-12 h-12 text-white"})}),e.jsx("p",{className:"text-[10px] font-black text-white uppercase tracking-[0.4em]",children:i.empty})]})}),e.jsxs("button",{onClick:C,disabled:!s.length,className:`mt-10 py-5 rounded-2xl font-black text-xs uppercase tracking-[0.2em] transition-all duration-500 flex items-center justify-center gap-3 shadow-2xl ${s.length?"glass-cta shadow-indigo-500/20":"bg-white/5 text-slate-600 cursor-not-allowed border border-white/5"}`,children:[i.execute," ",e.jsx(N,{className:"w-4 h-4"})]})]})]})};export{oe as DataRestructurer};
