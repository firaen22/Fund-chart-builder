import{c as g,r as y,A as k,T as D,j as r}from"./index-pOn6_Ak2.js";import{T as j}from"./target-BkaqhzqD.js";import{C as M}from"./calendar-BZL4daBu.js";import{C as N}from"./circle-check-DLqwLO0y.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],C=g("calculator",R);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],A=g("chart-no-axes-column",S);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],z=g("percent",_);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],V=g("shield",q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],F=g("triangle-alert",$),I=t=>{if(t.length<2)return 0;const a=t[0];return(t[t.length-1]-a)/a},T=t=>{let a=-1/0,n=0;for(const i of t){i>a&&(a=i);const u=(i-a)/a;u<n&&(n=u)}return n},E=t=>{if(t.length<2)return 0;const a=[];for(let o=1;o<t.length;o++)a.push((t[o]-t[o-1])/t[o-1]);const n=a.reduce((o,c)=>o+c,0)/a.length,i=a.reduce((o,c)=>o+Math.pow(c-n,2),0)/a.length;return Math.sqrt(i)*Math.sqrt(252)},L=(t,a=0)=>{if(t.length<2)return 0;const n=[];for(let e=1;e<t.length;e++)n.push((t[e]-t[e-1])/t[e-1]);const i=n.reduce((e,s)=>e+s,0)/n.length,u=n.reduce((e,s)=>e+Math.pow(s-i,2),0)/n.length,o=Math.sqrt(u);if(o===0)return 0;const c=Math.pow(1+i,252)-1,l=o*Math.sqrt(252);return(c-a)/l},B=(t,a=14)=>{if(t.length<=a)return 0;const n=[],i=[];for(let l=1;l<t.length;l++){const e=t[l]-t[l-1];e>=0?(n.push(e),i.push(0)):(n.push(0),i.push(Math.abs(e)))}let u=n.slice(0,a).reduce((l,e)=>l+e,0)/a,o=i.slice(0,a).reduce((l,e)=>l+e,0)/a;for(let l=a;l<t.length-1;l++){const e=n[l],s=i[l];u=(u*(a-1)+e)/a,o=(o*(a-1)+s)/a}return o===0?100:100-100/(1+u/o)},G=(t,a=0)=>{if(t.length<2)return 0;const n=[];for(let s=1;s<t.length;s++)n.push((t[s]-t[s-1])/t[s-1]);const i=n.reduce((s,h)=>s+h,0)/n.length,o=n.map(s=>s<0?s:0).reduce((s,h)=>s+Math.pow(h,2),0)/n.length;if(o===0)return 0;const c=Math.sqrt(o),l=Math.pow(1+i,252)-1,e=c*Math.sqrt(252);return(l-a)/e},U=(t,a)=>{if(t.length<2||a.length<2||t.length!==a.length)return;const n=[],i=[];for(let e=1;e<t.length;e++)n.push((t[e]-t[e-1])/t[e-1]),i.push((a[e]-a[e-1])/a[e-1]);const u=n.reduce((e,s)=>e+s,0)/n.length,o=i.reduce((e,s)=>e+s,0)/i.length;let c=0,l=0;for(let e=0;e<n.length;e++)c+=(n[e]-u)*(i[e]-o),l+=Math.pow(i[e]-o,2);if(c/=n.length,l/=i.length,l!==0)return c/l},W=(t,a,n,i=0)=>{if(t.length<2||a.length<2||t.length!==a.length)return;const u=l=>{const e=[];for(let h=1;h<l.length;h++)e.push((l[h]-l[h-1])/l[h-1]);const s=e.reduce((h,b)=>h+b,0)/e.length;return Math.pow(1+s,252)-1},o=u(t),c=u(a);return o-i-n*(c-i)},H=(t,a,n,i,u)=>{let o=t;n&&i&&(o=t.filter(s=>s.date>=n&&s.date<=i));const c=o.map(s=>s[a]).filter(s=>typeof s=="number");if(c.length===0)return null;let l,e;if(u&&u!==a){const s=o.map(h=>h[u]).filter(h=>typeof h=="number");s.length===c.length&&(l=U(c,s),l!==void 0&&(e=W(c,s,l)))}return{cumulativeReturn:I(c),maxDrawdown:T(c),volatility:E(c),sharpeRatio:L(c),sortinoRatio:G(c),rsi:B(c),beta:l,alpha:e}},X=({dataset:t,lang:a})=>{const[n,i]=y.useState(()=>t.data.length>0?t.data[0].date:""),[u,o]=y.useState(()=>t.data.length>0?t.data[t.data.length-1].date:""),[c,l]=y.useState({sharpeRatio:!1,maxDrawdown:!0,cumulativeReturn:!0,volatility:!1,rsi:!1,sortinoRatio:!0,beta:!1,alpha:!1}),e={en:{title:"Financial Metrics",subtitle:"Advanced quantitative analysis",dateRange:"Analysis Period",metrics:"Select Indicators",sharpe:"Sharpe Ratio",sharpeDesc:"Risk-adjusted return",sortino:"Sortino Ratio",sortinoDesc:"Downside risk-adjusted return",mdd:"Max Drawdown",mddDesc:"Worst possible loss",return:"Cumulative Return",returnDesc:"Total profit/loss",volatility:"Ann. Volatility",volatilityDesc:"Price stability",beta:"Beta",betaDesc:"Market volatility vs benchmark",alpha:"Alpha",alphaDesc:"Excess return vs benchmark",rsi:"RSI (14)",rsiDesc:"Momentum indicator",fund:"Fund Name",noData:"No data available for the selected range."},cn:{title:"財務指標分析",subtitle:"高級定量分析",dateRange:"分析期間",metrics:"選擇指標",sharpe:"夏普比率",sharpeDesc:"每一單位風險的超額回報",sortino:"索提諾比率",sortinoDesc:"下行風險調整後回報",mdd:"最大回撤",mddDesc:"期間內最大跌幅",return:"累積回報",returnDesc:"期間總獲利",volatility:"年化波動率",volatilityDesc:"價格變動劇烈程度",beta:"貝塔係數 (Beta)",betaDesc:"相對於基準的波動性",alpha:"阿爾法 (Alpha)",alphaDesc:"相對於基準的超額回報",rsi:"相對強弱指數 (RSI)",rsiDesc:"趨勢與買賣力道",fund:"基金名稱",noData:"所選範圍內無數據。"}}[a],s=[{key:"cumulativeReturn",label:e.return,desc:e.returnDesc,icon:z,color:"text-emerald-600"},{key:"maxDrawdown",label:e.mdd,desc:e.mddDesc,icon:F,color:"text-red-500"},{key:"sharpeRatio",label:e.sharpe,desc:e.sharpeDesc,icon:k,color:"text-indigo-600"},{key:"sortinoRatio",label:e.sortino,desc:e.sortinoDesc,icon:V,color:"text-sky-500"},{key:"volatility",label:e.volatility,desc:e.volatilityDesc,icon:k,color:"text-orange-500"},{key:"beta",label:e.beta,desc:e.betaDesc,icon:D,color:"text-rose-500"},{key:"alpha",label:e.alpha,desc:e.alphaDesc,icon:j,color:"text-amber-500"},{key:"rsi",label:e.rsi,desc:e.rsiDesc,icon:A,color:"text-purple-600"}],h=y.useMemo(()=>{const d={},p=t.funds.length>0?t.funds[0]:void 0;return t.funds.forEach(x=>{d[x]=H(t.data,x,n,u,p)}),d},[t,n,u]),b=d=>{l(p=>({...p,[d]:!p[d]}))},v=s.filter(d=>c[d.key]);return r.jsxs("div",{className:"bg-white rounded-3xl border border-surface-200 shadow-lg overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"px-6 py-5 bg-surface-50 border-b border-surface-200 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"bg-brand-100 p-2 rounded-lg text-brand-700",children:r.jsx(C,{className:"w-5 h-5"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-bold text-surface-900 uppercase tracking-widest",children:e.title}),r.jsx("p",{className:"text-[10px] text-surface-500 font-medium",children:e.subtitle})]})]}),r.jsxs("div",{className:"flex items-center gap-2 bg-white p-1 rounded-lg border border-surface-200 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 border-r border-surface-100",children:[r.jsx(M,{className:"w-3.5 h-3.5 text-surface-400"}),r.jsx("span",{className:"text-[10px] font-bold text-surface-500 uppercase tracking-wider",children:e.dateRange})]}),r.jsx("input",{type:"date",value:n,onChange:d=>i(d.target.value),className:"text-xs font-mono font-bold text-surface-900 bg-transparent border-none focus:ring-0 p-1"}),r.jsx("span",{className:"text-surface-300",children:"-"}),r.jsx("input",{type:"date",value:u,onChange:d=>o(d.target.value),className:"text-xs font-mono font-bold text-surface-900 bg-transparent border-none focus:ring-0 p-1"})]})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsx("div",{className:"flex flex-wrap gap-3",children:s.map(d=>r.jsxs("button",{onClick:()=>b(d.key),className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all duration-200 ease-out active:scale-95 ${c[d.key]?"bg-brand-50 border-brand-200 shadow-sm":"bg-white border-surface-200 hover:bg-surface-50 text-surface-400"}`,children:[r.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${c[d.key]?"bg-brand-500 text-white":"bg-surface-200"}`,children:c[d.key]&&r.jsx(N,{className:"w-3 h-3 animate-in zoom-in duration-300 ease-out"})}),r.jsx("div",{className:"text-left",children:r.jsx("span",{className:`block text-[10px] font-bold uppercase tracking-wider ${c[d.key]?"text-brand-900":"text-surface-500"}`,children:d.label})})]},d.key))}),r.jsxs("div",{className:"overflow-x-auto rounded-xl border border-surface-200",children:[r.jsxs("table",{className:"w-full text-left",children:[r.jsx("thead",{className:"bg-surface-50/80 text-[10px] font-bold uppercase text-surface-500 tracking-widest border-b border-surface-200",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 bg-surface-50 sticky left-0 z-10",children:e.fund}),v.map(d=>r.jsx("th",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(d.icon,{className:`w-3.5 h-3.5 ${d.color}`}),r.jsx("span",{children:d.label})]})},d.key))]})}),r.jsx("tbody",{className:"divide-y divide-surface-100 font-mono text-xs",children:t.funds.map(d=>{const p=h[d];return p?r.jsxs("tr",{className:"hover:bg-brand-50/30 transition-colors group",children:[r.jsx("td",{className:"px-6 py-4 font-bold text-surface-900 bg-white group-hover:bg-brand-50/30 sticky left-0 border-r border-surface-100 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]",children:d}),v.map(x=>{let f=p[x.key],w="—",m="text-surface-600";return f!=null&&!isNaN(f)&&(x.key==="cumulativeReturn"||x.key==="maxDrawdown"||x.key==="volatility"||x.key==="alpha"?(w=(f*100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+"%",x.key==="cumulativeReturn"||x.key==="alpha"?m=f>=0?"text-emerald-600 font-bold":"text-red-500 font-bold":x.key==="maxDrawdown"&&(m="text-red-500 font-bold")):(w=f.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),(x.key==="sharpeRatio"||x.key==="sortinoRatio")&&(m=f>1?"text-emerald-600 font-bold":f<0?"text-red-500":"text-surface-700"))),r.jsx("td",{className:`px-6 py-4 tabular-nums ${m}`,children:w},x.key)})]},d):null})})]}),v.length===0&&r.jsx("div",{className:"p-8 text-center text-surface-400 text-sm font-medium italic",children:e.metrics})]})]})]})};export{X as FinancialMetrics};
